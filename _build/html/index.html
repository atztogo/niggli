
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Niggli cell &mdash; niggli 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="niggli 0.1 documentation" href="#" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li><a href="#">niggli 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="niggli-cell">
<span id="id1"></span><h1>Niggli cell<a class="headerlink" href="#niggli-cell" title="Permalink to this headline">¶</a></h1>
<div class="section" id="algorithm-to-determine-niggli-cell">
<h2>Algorithm to determine Niggli cell<a class="headerlink" href="#algorithm-to-determine-niggli-cell" title="Permalink to this headline">¶</a></h2>
<div class="section" id="reference">
<h3>Reference<a class="headerlink" href="#reference" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>A Unified Algorithm for Determining the Reduced (Niggli) Cell,
I. Krivý and B. Gruber, Acta Cryst., A32, 297-298 (1976)</li>
<li>The Relationship between Reduced Cells in a General Bravais lattice,
B. Gruber, Acta Cryst., A29, 433-440 (1973)</li>
<li>Numerically stable algorithms for the computation of reduced unit cells,
R. W. Grosse-Kunstleve, N. K. Sauter and P. D. Adams, Acta
Cryst., A60, 1-6 (2004)</li>
</ol>
</div>
<div class="section" id="algorithm">
<h3>Algorithm<a class="headerlink" href="#algorithm" title="Permalink to this headline">¶</a></h3>
<div class="section" id="a0">
<h4>A0<a class="headerlink" href="#a0" title="Permalink to this headline">¶</a></h4>
<p>Define following variables as</p>
<div class="math">
<p><img src="_images/math/b9233bcc8d78c5a7765deb1025c24651388873cc.png" alt="&amp;A = \mathbf{a}\cdot\mathbf{a}\\
&amp;B = \mathbf{b}\cdot\mathbf{b}\\
&amp;C = \mathbf{c}\cdot\mathbf{c}\\
&amp;\xi=2\mathbf{b}\cdot\mathbf{c}\\
&amp;\eta=2\mathbf{c}\cdot\mathbf{a}\\
&amp;\zeta=2\mathbf{a}\cdot\mathbf{b}."/></p>
</div><p>They are elements of metric tensor where the off-diagonal elements are
doubled. Therefore the metric tensor <img class="math" src="_images/math/597c852cd8d4be79f01a80b6317d2096dd10c544.png" alt="\mathbf{G}"/> is represented as</p>
<div class="math">
<p><img src="_images/math/9f809169f909cfc56946095b5606c3bce7f44c34.png" alt="\mathbf{G} =
\begin{pmatrix}
A &amp; \zeta/2 &amp; \eta/2 \\
\zeta/2 &amp; B &amp; \xi/2 \\
\eta/2 &amp; \xi/2 &amp; C
\end{pmatrix}."/></p>
</div><p><img class="math" src="_images/math/ccfd1641d037d427d9dbf42cdd54b485a03eafe9.png" alt="\xi"/>, <img class="math" src="_images/math/03a45952f8115322d2879f7d090126f059757ba0.png" alt="\eta"/>, <img class="math" src="_images/math/fda38f45a64bbd4451aedeeb4584e01d91239172.png" alt="\zeta"/> are sorted by their ranges of
angles as shown below.</p>
<table border="1" class="docutils">
<colgroup>
<col width="58%" />
<col width="42%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Angle</th>
<th class="head">value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Acute</td>
<td>1</td>
</tr>
<tr class="row-odd"><td>Obtuse</td>
<td>-1</td>
</tr>
<tr class="row-even"><td>Right</td>
<td>0</td>
</tr>
</tbody>
</table>
<p>These values are stored in variables <img class="math" src="_images/math/870efb33135d4f926a4d345565b3d3c7ad919fba.png" alt="l, m, n"/> as follows.</p>
<ul class="simple">
<li>Set initially <img class="math" src="_images/math/7a2ab7481b4c76e4a0a040646663c8acb20c0207.png" alt="l=m=n=0"/>.</li>
<li>If <img class="math" src="_images/math/4ce4f1a6b4435093189ffd03fbde14aedd7cbd58.png" alt="\xi&lt;-\varepsilon"/>, <img class="math" src="_images/math/51eb7e374e8267b4ff2ca6ff9d68bbb7675c0e16.png" alt="l=-1"/>.</li>
<li>If <img class="math" src="_images/math/1532ca997b57676f872c38756de68e035ffc9146.png" alt="\xi&gt;\varepsilon"/>, <img class="math" src="_images/math/bf7d802f36cb7350777c714781c597141d2d6796.png" alt="l=1"/>.</li>
<li>If <img class="math" src="_images/math/a558751ad0230fc1858376ac67d974ad5f19cd85.png" alt="\eta&lt;-\varepsilon"/>, <img class="math" src="_images/math/4d4d288a994505787ed18fd2edcb86b6f85587d1.png" alt="m=-1"/>.</li>
<li>If <img class="math" src="_images/math/437f2241c30a823dd5c27b45c754a89be4788981.png" alt="\eta&gt;\varepsilon"/>, <img class="math" src="_images/math/a4b5800f5ad040d308609190ef18a9e0ca08a9b0.png" alt="m=1"/>.</li>
<li>If <img class="math" src="_images/math/0e75d7da36d45fe572d6b7853536355cc170bc53.png" alt="\zeta&lt;-\varepsilon"/>, <img class="math" src="_images/math/abffc6551fd537142e5ae0d6907dc57c4f42cd84.png" alt="n=-1"/>.</li>
<li>If <img class="math" src="_images/math/e852872ccb1460477d833e93994cc4a28eb939e5.png" alt="\zeta&gt;\varepsilon"/>, <img class="math" src="_images/math/1d96ecc15129c5631ba4a2c6578e91e3d13e3baf.png" alt="n=1"/>.</li>
</ul>
</div>
<div class="section" id="a1">
<h4>A1<a class="headerlink" href="#a1" title="Permalink to this headline">¶</a></h4>
<p>If <img class="math" src="_images/math/3c12e446bb7b35535445d5fa101ceea266354ea6.png" alt="A &gt; B + \varepsilon"/> or
(<img class="math" src="_images/math/160cbffb4a84d6d7afc2cdda3308f05754202092.png" alt="\overline{|A-B|&gt;\varepsilon}"/> and <img class="math" src="_images/math/538d6317785fdfb2fbe03cf93723dd9967c85a03.png" alt="|\xi|&gt;|\eta| + \varepsilon"/>),</p>
<div class="math">
<p><img src="_images/math/814ecfee09fc326e249a573f0c5bce876684bf67.png" alt="\mathbf{C} =
\begin{pmatrix}
0 &amp; -1 &amp; 0 \\
-1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; -1 \\
\end{pmatrix}."/></p>
</div><p>Run A0.</p>
</div>
<div class="section" id="a2">
<h4>A2<a class="headerlink" href="#a2" title="Permalink to this headline">¶</a></h4>
<p>If <img class="math" src="_images/math/e10bcfa3d83808bf9ca6b62b187bef9666a77845.png" alt="B &gt; C + \varepsilon"/> or (<img class="math" src="_images/math/cf165d75b29214b94994629df6abc3a73c395def.png" alt="\overline{|B-C|&gt;\varepsilon}"/>
and <img class="math" src="_images/math/c7c82878f998b70a41493264346f88f26169bf4f.png" alt="|\eta|&gt;|\zeta| + \varepsilon"/>),</p>
<div class="math">
<p><img src="_images/math/1a5321cc80428d98a181f0cd38cd70d1f429d35a.png" alt="\mathbf{C} =
\begin{pmatrix}
-1 &amp; 0 &amp; 0 \\
0 &amp; 0 &amp; -1 \\
0 &amp; -1 &amp; 0 \\
\end{pmatrix}."/></p>
</div><p>Go to A0.</p>
</div>
<div class="section" id="a3">
<h4>A3<a class="headerlink" href="#a3" title="Permalink to this headline">¶</a></h4>
<p>If <img class="math" src="_images/math/38f416b6427731abaa037b161e44452f6fd9db24.png" alt="lmn = 1"/>:</p>
<ul class="simple">
<li><img class="math" src="_images/math/08eb69bd26966cc7c9879aa3ada687ca1d39427d.png" alt="i=-1"/> if <img class="math" src="_images/math/51eb7e374e8267b4ff2ca6ff9d68bbb7675c0e16.png" alt="l=-1"/> else <img class="math" src="_images/math/50ed4b89a6aeb4814026a2be01bde8bd7d264b71.png" alt="i=1"/></li>
<li><img class="math" src="_images/math/94e6c73b2748b7eed68c23a21c76bc5644b9c7b7.png" alt="j=-1"/> if <img class="math" src="_images/math/4d4d288a994505787ed18fd2edcb86b6f85587d1.png" alt="m=-1"/> else <img class="math" src="_images/math/5db39120014c34e1b098a3090ebd37598244d404.png" alt="j=1"/></li>
<li><img class="math" src="_images/math/db97681e49591a8b330c0dfa9907ee21c2feca2b.png" alt="k=-1"/> if <img class="math" src="_images/math/abffc6551fd537142e5ae0d6907dc57c4f42cd84.png" alt="n=-1"/> else <img class="math" src="_images/math/5ed8470bc717a49aafe4556c7e2c2e11ddc7b687.png" alt="k=1"/></li>
</ul>
<div class="math">
<p><img src="_images/math/6cb875846608bb1e322fdf0f855821e91d6aa159.png" alt="\mathbf{C} =
\begin{pmatrix}
i &amp; 0 &amp; 0 \\
0 &amp; j &amp; 0 \\
0 &amp; 0 &amp; k \\
\end{pmatrix}."/></p>
</div><p>Run A0.</p>
</div>
<div class="section" id="a4">
<h4>A4<a class="headerlink" href="#a4" title="Permalink to this headline">¶</a></h4>
<p>If <img class="math" src="_images/math/fd1c38d10b04b4314137640a10f9cc1de3871aa4.png" alt="lmn = 0"/> or <img class="math" src="_images/math/8f0eacdb38c9c41929900f77adc01c1c87aff949.png" alt="lmn = -1"/>:</p>
<ul class="simple">
<li><img class="math" src="_images/math/08eb69bd26966cc7c9879aa3ada687ca1d39427d.png" alt="i=-1"/> if <img class="math" src="_images/math/bf7d802f36cb7350777c714781c597141d2d6796.png" alt="l=1"/> else <img class="math" src="_images/math/50ed4b89a6aeb4814026a2be01bde8bd7d264b71.png" alt="i=1"/></li>
<li><img class="math" src="_images/math/94e6c73b2748b7eed68c23a21c76bc5644b9c7b7.png" alt="j=-1"/> if <img class="math" src="_images/math/a4b5800f5ad040d308609190ef18a9e0ca08a9b0.png" alt="m=1"/> else <img class="math" src="_images/math/5db39120014c34e1b098a3090ebd37598244d404.png" alt="j=1"/></li>
<li><img class="math" src="_images/math/db97681e49591a8b330c0dfa9907ee21c2feca2b.png" alt="k=-1"/> if <img class="math" src="_images/math/1d96ecc15129c5631ba4a2c6578e91e3d13e3baf.png" alt="n=1"/> else <img class="math" src="_images/math/5ed8470bc717a49aafe4556c7e2c2e11ddc7b687.png" alt="k=1"/></li>
</ul>
<p>If <img class="math" src="_images/math/9fdd2a6f1d11c1ff1bcb21d51314aaacf166c8ee.png" alt="ijk=-1"/>, then overwrite <img class="math" src="_images/math/a2d90b0ab7269c8f0c7109f1c7a3bdfa3a5fa49c.png" alt="i,j,k"/>:</p>
<ul class="simple">
<li><img class="math" src="_images/math/08eb69bd26966cc7c9879aa3ada687ca1d39427d.png" alt="i=-1"/> if <img class="math" src="_images/math/f5644099294a33bf6ea99f64e0eba8cb70bbc020.png" alt="l=0"/></li>
<li><img class="math" src="_images/math/94e6c73b2748b7eed68c23a21c76bc5644b9c7b7.png" alt="j=-1"/> if <img class="math" src="_images/math/2e275495e7e44d279fb3e5051b3a63115e79ead5.png" alt="m=0"/></li>
<li><img class="math" src="_images/math/db97681e49591a8b330c0dfa9907ee21c2feca2b.png" alt="k=-1"/> if <img class="math" src="_images/math/02349576cee613512cdf301a365f06c0760acab5.png" alt="n=0"/></li>
</ul>
<div class="math">
<p><img src="_images/math/6cb875846608bb1e322fdf0f855821e91d6aa159.png" alt="\mathbf{C} =
\begin{pmatrix}
i &amp; 0 &amp; 0 \\
0 &amp; j &amp; 0 \\
0 &amp; 0 &amp; k \\
\end{pmatrix}."/></p>
</div><p>Run A0.</p>
</div>
<div class="section" id="a5">
<h4>A5<a class="headerlink" href="#a5" title="Permalink to this headline">¶</a></h4>
<p>If <img class="math" src="_images/math/00609093ba793c0ce8c9fbdcc9bbcb1702c37308.png" alt="|\xi|&gt;B + \varepsilon"/> or <img class="math" src="_images/math/965209261b60122d352b5ef91474e5c327b5f3a2.png" alt="(\overline{|B - \xi| &gt; \varepsilon}"/> and <img class="math" src="_images/math/11a3d140578e21d651e14d19f114e9d8ad20f1f7.png" alt="2\eta&lt; \zeta
-\varepsilon)"/> or <img class="math" src="_images/math/f8e299bcd330504bd82485eef6529d3621a6cec9.png" alt="(\overline{|B + \xi| &gt; \varepsilon}"/> and <img class="math" src="_images/math/8f7fbcfe5e30ceef0c685fcac7685fbcee1a74eb.png" alt="\zeta&lt; -\varepsilon)"/>:</p>
<div class="math">
<p><img src="_images/math/ca292f5c1de679b613d92c4f0185196701e90599.png" alt="\mathbf{C} =
\begin{pmatrix}
1 &amp; 0 &amp; 0 \\
0 &amp; 1 &amp; -\mathrm{sign}(\xi) \\
0 &amp; 0 &amp; 1 \\
\end{pmatrix}."/></p>
</div><p>Go to A0.</p>
</div>
<div class="section" id="a6">
<h4>A6<a class="headerlink" href="#a6" title="Permalink to this headline">¶</a></h4>
<p>If <img class="math" src="_images/math/665c67efc22e8999dbc2fc117517925419a35363.png" alt="|\eta|&gt;A + \varepsilon"/> or <img class="math" src="_images/math/32a3a406219dbba31e60cc82a5de3fe8174fdde2.png" alt="(\overline{|A - \eta| &gt; \varepsilon}"/>
and <img class="math" src="_images/math/5586787fc09e2c965f9448cb0f6d01c2967403a8.png" alt="2\xi &lt; \zeta -\varepsilon)"/> or <img class="math" src="_images/math/cf75fa95841dd3d331b26ac09b6d204ef78a34ea.png" alt="(\overline{|A + \eta| &gt;
\varepsilon}"/> and <img class="math" src="_images/math/8f7fbcfe5e30ceef0c685fcac7685fbcee1a74eb.png" alt="\zeta&lt; -\varepsilon)"/>:</p>
<div class="math">
<p><img src="_images/math/ff339453998f95e030f5e8c8134a647aff2a004f.png" alt="\mathbf{C} =
\begin{pmatrix}
1 &amp; 0 &amp; -\mathrm{sign}(\eta) \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
\end{pmatrix}."/></p>
</div><p>Go to A0.</p>
</div>
<div class="section" id="a7">
<h4>A7<a class="headerlink" href="#a7" title="Permalink to this headline">¶</a></h4>
<p>If <img class="math" src="_images/math/fe1868ae92f51abb5181d300493abbbdee10ce33.png" alt="|\zeta|&gt;A + \varepsilon"/> or <img class="math" src="_images/math/9c89d399604b96d9c3d074c994edaca7a43ea508.png" alt="(\overline{|A - \zeta| &gt; \varepsilon},
2\xi &lt; \eta -\varepsilon)"/> or <img class="math" src="_images/math/46b4bdf2184a208a84ef0de8b87cec5742670b7c.png" alt="(\overline{|A + \zeta| &gt; \varepsilon}"/> and <img class="math" src="_images/math/5af872508a3de7d0724d90c76e794061d20ba67a.png" alt="\eta&lt; -\varepsilon)"/>:</p>
<div class="math">
<p><img src="_images/math/5dc95036abef8e2373698dd5bf0e3763e0700858.png" alt="\mathbf{C} =
\begin{pmatrix}
1 &amp; -\mathrm{sign}(\zeta) &amp; 0 \\
0 &amp; 1 &amp; 0 \\
0 &amp; 0 &amp; 1 \\
\end{pmatrix}."/></p>
</div><p>Go to A0.</p>
</div>
<div class="section" id="a8">
<h4>A8<a class="headerlink" href="#a8" title="Permalink to this headline">¶</a></h4>
<p>If <img class="math" src="_images/math/fc54a3176fb6a46d8dc8ab512eb8a1b9629b3f36.png" alt="\xi + \eta + \zeta + A + B &lt; -\varepsilon"/> or <img class="math" src="_images/math/fddd097ddfeaa2c8e2e15f70b895c42b48d7a9d6.png" alt="(\overline{|\xi +
\eta + \zeta + A + B| &gt; \varepsilon}"/> and <img class="math" src="_images/math/22eb21582f58ecfcaea176e2b69bac0a117a8af7.png" alt="2(A + \eta) + \zeta &gt; \varepsilon)"/>:</p>
<div class="math">
<p><img src="_images/math/60e19cabca996cdb050c26767bbcf30e44568605.png" alt="\mathbf{C} =
\begin{pmatrix}
1 &amp; 0 &amp; 1 \\
0 &amp; 1 &amp; 1 \\
0 &amp; 0 &amp; 1 \\
\end{pmatrix}."/></p>
</div><p>Go to A0.</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Niggli cell</a><ul>
<li><a class="reference internal" href="#algorithm-to-determine-niggli-cell">Algorithm to determine Niggli cell</a><ul>
<li><a class="reference internal" href="#reference">Reference</a></li>
<li><a class="reference internal" href="#algorithm">Algorithm</a><ul>
<li><a class="reference internal" href="#a0">A0</a></li>
<li><a class="reference internal" href="#a1">A1</a></li>
<li><a class="reference internal" href="#a2">A2</a></li>
<li><a class="reference internal" href="#a3">A3</a></li>
<li><a class="reference internal" href="#a4">A4</a></li>
<li><a class="reference internal" href="#a5">A5</a></li>
<li><a class="reference internal" href="#a6">A6</a></li>
<li><a class="reference internal" href="#a7">A7</a></li>
<li><a class="reference internal" href="#a8">A8</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/index.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li><a href="#">niggli 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Atsushi Togo.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>